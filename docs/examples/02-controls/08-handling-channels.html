
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>08-handling-channels.py - Managing object’s internal audio streams. — Pyo 1.0.4 documentation</title>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/nature.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-codeautolink.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/autoclasstoc.css" rel="stylesheet" type="text/css"/>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/jquery.js"></script>
<script src="../../_static/underscore.js"></script>
<script src="../../_static/doctools.js"></script>
<link href="../../_static/E-PyoIcon.ico" rel="shortcut icon"/>
<link href="../../about.html" rel="author" title="About these documents"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="09-handling-channels-2.html" rel="next" title="09-handling-channels-2.py - The out method and the physical outputs."/>
<link href="07-multichannel-expansion-2.html" rel="prev" title="07-multichannel-expansion-2.py - Extended multichannel expansion."/>
</head><body>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../../genindex.html" title="General Index">index</a></li>
<li class="right">
<a accesskey="N" href="09-handling-channels-2.html" title="09-handling-channels-2.py - The out method and the physical outputs.">next</a> |</li>
<li class="right">
<a accesskey="P" href="07-multichannel-expansion-2.html" title="07-multichannel-expansion-2.py - Extended multichannel expansion.">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="../../index.html">Pyo 1.0.4 documentation</a> »</li>
<li class="nav-item nav-item-1"><a accesskey="U" href="index.html">02-controls</a> »</li>
<li class="nav-item nav-item-this"><a href="">08-handling-channels.py - Managing object’s internal audio streams.</a></li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="handling-channels-py-managing-object-s-internal-audio-streams">
<h1>08-handling-channels.py - Managing object’s internal audio streams.<a class="headerlink" href="#handling-channels-py-managing-object-s-internal-audio-streams" title="Permalink to this headline">¶</a></h1>
<p>Because audio objects expand their number of streams according to lists
given to their arguments and the fact that an audio object is considered
as a list, if a multi-streams object is given as an argument to another
audio object, the later will also be expanded in order to process all
given streams. This is really powerful to create polyphonic processes
without copying long chunks of code but it can be very CPU expensive.</p>
<p>In this example, we create a square from a sum of sine waves. After that,
a chorus is applied to the resulting waveform. If we don’t mix down the
square wave, we got tens of Chorus objects in the processing chain (one
per sine). This can easily overrun the CPU. The exact same result can
be obtained with only one Chorus applied to the sum of the sine waves.
The <cite>mix(voices)</cite> method of the PyoObject helps the handling of channels
in order to save CPU cycles. Here, we down mix all streams to only two
streams (to maintain the stereo) before processing the Chorus arguments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <a class="sphinx-codeautolink-a" href="../../api/alphabetical.html#module-pyo" title="pyo"><span class="nn">pyo</span></a> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/classes/server.html#pyo.Server" title="pyo.lib.server.Server"><span class="n">Server</span></a><span class="p">()</span><span class="o">.</span><span class="n">boot</span><span class="p">()</span>

<span class="c1"># Sets fundamental frequency and highest harmonic.</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">high</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># Generates lists for frequencies and amplitudes</span>
<span class="n">harms</span> <span class="o">=</span> <span class="p">[</span><span class="n">freq</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.33</span> <span class="o">/</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Creates a square wave by additive synthesis.</span>
<a class="sphinx-codeautolink-a" href="../../api/classes/generators.html#pyo.Sine" title="pyo.lib.generators.Sine"><span class="n">a</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/classes/generators.html#pyo.Sine" title="pyo.lib.generators.Sine"><span class="n">Sine</span></a><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="n">harms</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="n">amps</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Number of Sine streams: </span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="../../api/classes/generators.html#pyo.Sine" title="pyo.lib.generators.Sine"><span class="n">a</span></a><span class="p">))</span>

<span class="c1"># Mix down the number of streams of "a" before computing the Chorus.</span>
<span class="n">b</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../api/classes/effects.html#pyo.Chorus" title="pyo.lib.effects.Chorus"><span class="n">Chorus</span></a><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">feedback</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">out</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Number of Chorus streams: </span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="n">s</span><span class="o">.</span><span class="n">gui</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
</pre></div>
</div>
</section>
<div class="clearer"></div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h4>Previous topic</h4>
<p class="topless"><a href="07-multichannel-expansion-2.html" title="previous chapter">07-multichannel-expansion-2.py - Extended multichannel expansion.</a></p>
<h4>Next topic</h4>
<p class="topless"><a href="09-handling-channels-2.html" title="next chapter">09-handling-channels-2.py - The <cite>out</cite> method and the physical outputs.</a></p>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="../../search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script>$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="../../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="09-handling-channels-2.html" title="09-handling-channels-2.py - The out method and the physical outputs.">next</a> |</li>
<li class="right">
<a href="07-multichannel-expansion-2.html" title="07-multichannel-expansion-2.py - Extended multichannel expansion.">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="../../index.html">Pyo 1.0.4 documentation</a> »</li>
<li class="nav-item nav-item-1"><a href="index.html">02-controls</a> »</li>
<li class="nav-item nav-item-this"><a href="">08-handling-channels.py - Managing object’s internal audio streams.</a></li>
</ul>
</div>
<div class="footer" role="contentinfo">
        © Copyright 2021, Olivier Bélanger.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
</body>
</html>